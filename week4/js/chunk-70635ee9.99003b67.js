(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70635ee9"],{"0bb5":function(t,e,a){"use strict";var o=a("2453"),i=a.n(o);i.a},2453:function(t,e,a){},2532:function(t,e,a){"use strict";var o=a("23e7"),i=a("5a34"),n=a("1d80"),s=a("ab13");o({target:"String",proto:!0,forced:!s("includes")},{includes:function(t){return!!~String(n(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},"4c33":function(t,e,a){"use strict";var o=a("7b4f"),i=a.n(o);i.a},"53c8":function(t,e,a){},"587b":function(t,e,a){"use strict";var o=a("53c8"),i=a.n(o);i.a},"5a34":function(t,e,a){var o=a("44e7");t.exports=function(t){if(o(t))throw TypeError("The method doesn't accept regular expressions");return t}},"795d":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"item-manage",attrs:{id:"item-manage"}},[t._m(0),a("button",{staticClass:"add",attrs:{"data-action":"add"},on:{click:function(e){return t.openPage()}}},[a("font-awesome-icon",{attrs:{icon:["fas","plus"]}}),t._v("新增")],1),a("button",{staticClass:"add circle",class:{show:t.addShow},attrs:{title:"新增商品","data-action":"add","track-by":"$index"},on:{click:function(e){return t.openPage()}}},[a("font-awesome-icon",{attrs:{icon:["fas","plus"]}})],1),a("table",[t._m(1),t._l(t.products,(function(e,o){return a("tr",{key:e.id,staticClass:"item-list",attrs:{"data-id":e.id,"data-index":o}},[a("td",{staticClass:"col"},[a("div",{staticClass:"text"},[t._v(t._s(e.category))])]),a("td",{staticClass:"col"},[a("img",{attrs:{src:e.imageUrl}})]),a("td",{staticClass:"col"},[a("div",{staticClass:"text"},[t._v(t._s(e.title))])]),a("td",{staticClass:"col"},[a("div",{staticClass:"text"},[t._v(t._s(e.content))])]),a("td",{staticClass:"col"},[a("div",{staticClass:"text"},[t._v(t._s(e.description))])]),a("td",{staticClass:"col"},[a("font-awesome-icon",{class:e.enabled?"check":"times",attrs:{icon:e.enabled?["fas","check"]:["fas","times"]}})],1),a("td",{staticClass:"col"},[t._v(t._s(e.origin_price))]),a("td",{staticClass:"col"},[t._v(t._s(e.price))]),a("td",{staticClass:"col"},[t._v(t._s(e.options?e.options.store:0))]),a("td",{staticClass:"col"},[a("button",{staticClass:"update",attrs:{"data-action":"update"},on:{click:function(e){return t.openPage(o)}}},[a("font-awesome-icon",{attrs:{icon:["fas","edit"]}}),t._v("修改")],1),a("button",{staticClass:"del",on:{click:function(e){return t.deleteProduct(o)}}},[a("font-awesome-icon",{attrs:{icon:["fas","trash-alt"]}}),t._v("刪除")],1)])])}))],2),a("productPage",{class:{open:t.productPage.open},attrs:{addNewItem:t.addNewItem},on:{"update:addNewItem":function(e){t.addNewItem=e},"update:add-new-item":function(e){t.addNewItem=e}}}),t.pagination.current_page?[a("pagination",{attrs:{pagination:t.pagination}})]:t._e(),a("vue-confirm-dialog")],2)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"nav"},[a("div",{staticClass:"nav-title"},[a("h2",[t._v("產品管理介面")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",{staticClass:"title"},[a("th",{staticClass:"col"},[t._v("分類")]),a("th",{staticClass:"col"},[t._v("圖片")]),a("th",{staticClass:"col"},[t._v("標題")]),a("th",{staticClass:"col"},[t._v("說明")]),a("th",{staticClass:"col"},[t._v("描述")]),a("th",{staticClass:"col"},[t._v("是否啟用")]),a("th",{staticClass:"col"},[t._v("原價")]),a("th",{staticClass:"col"},[t._v("售價")]),a("th",{staticClass:"col"},[t._v("庫存")]),a("th",{staticClass:"col"},[t._v("編輯")])])}];a("a4d3"),a("e01a"),a("d81d"),a("d28b"),a("d3b7"),a("3ca3"),a("ddb0");function n(t){return n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}var s=a("5530"),c=a("2f62"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"newDataPage",attrs:{id:"newDataPage"},on:{click:t.toggle}},[a("div",{ref:"productPage",staticClass:"container"},[a("div",{staticClass:"loading",class:{show:t.loading}},[a("font-awesome-icon",{staticClass:"fa-3x fa-spin",attrs:{icon:["fa","spinner"]}})],1),a("div",{staticClass:"row-100 row-title"},[a("div",{staticClass:"page-title"},[a("span",[a("h3",[t._v(t._s(t.pid?"更新":"新增")+"商品")])])])]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"title"}},[t._v("名稱")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.title,expression:"tempProduct.title"}],staticClass:"required",attrs:{id:"title",type:"text"},domProps:{value:t.tempProduct.title},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"title",e.target.value)}}})]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"ategory"}},[t._v("分類")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.category,expression:"tempProduct.category"}],attrs:{id:"category",type:"text"},domProps:{value:t.tempProduct.category},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"category",e.target.value)}}})]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"content"}},[t._v("商品敘述")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.content,expression:"tempProduct.content"}],attrs:{id:"content",cols:"25",rows:"5"},domProps:{value:t.tempProduct.content},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"content",e.target.value)}}})]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"description"}},[t._v("商品說明")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.description,expression:"tempProduct.description"}],attrs:{id:"description",cols:"25",rows:"5"},domProps:{value:t.tempProduct.description},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"description",e.target.value)}}})]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"origin_price"}},[t._v("原價")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.origin_price,expression:"tempProduct.origin_price"}],attrs:{id:"origin_price",type:"number"},domProps:{value:t.tempProduct.origin_price},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"origin_price",e.target.value)}}})]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"price"}},[t._v("售價")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.price,expression:"tempProduct.price"}],attrs:{id:"price",type:"number"},domProps:{value:t.tempProduct.price},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"price",e.target.value)}}})]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"imageUrl"}},[t._v("輸入圖片網址")]),a("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.tempProduct.imageUrl[0],expression:"tempProduct.imageUrl[0]",modifiers:{lazy:!0}}],attrs:{id:"imageUrl",type:"text"},domProps:{value:t.tempProduct.imageUrl[0]},on:{change:function(e){return t.$set(t.tempProduct.imageUrl,0,e.target.value)}}}),a("div",{staticClass:"img"},[a("img",{attrs:{id:"preview",src:t.tempProduct.imageUrl[0],alt:""}})])]),a("div",{staticClass:"row"},[a("label",{attrs:{for:"price"}},[t._v("庫存")]),t.tempProduct.options?a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.options.store,expression:"tempProduct.options.store"}],attrs:{id:"store",type:"number",placeholder:"0"},domProps:{value:t.tempProduct.options.store},on:{input:function(e){e.target.composing||t.$set(t.tempProduct.options,"store",e.target.value)}}}):t._e(),a("label",{attrs:{for:"unit"}},[t._v("單位")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.unit,expression:"tempProduct.unit"}],attrs:{id:"price",type:"text"},domProps:{value:t.tempProduct.unit},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"unit",e.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.enabled,expression:"tempProduct.enabled"}],attrs:{id:"enabled",type:"checkbox"},domProps:{checked:Array.isArray(t.tempProduct.enabled)?t._i(t.tempProduct.enabled,null)>-1:t.tempProduct.enabled},on:{change:function(e){var a=t.tempProduct.enabled,o=e.target,i=!!o.checked;if(Array.isArray(a)){var n=null,s=t._i(a,n);o.checked?s<0&&t.$set(t.tempProduct,"enabled",a.concat([n])):s>-1&&t.$set(t.tempProduct,"enabled",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.tempProduct,"enabled",i)}}}),a("label",{attrs:{for:"enabled"}},[t._v("是否啟用")])]),a("div",{staticClass:"row-100"},[t.tempProduct.id?a("button",{attrs:{id:"update","data-action":"update",type:"button"},on:{click:function(e){return e.preventDefault(),t.edit(e)}}},[t._v("更新")]):a("button",{attrs:{id:"create","data-action":"create",type:"button"},on:{click:function(e){return e.preventDefault(),t.edit(e)}}},[t._v("新增")]),a("button",{attrs:{id:"cancel",type:"button"},on:{click:t.cancel}},[t._v("取消")])])])])},d=[],u=(a("caad"),a("2532"),a("2803")),p={name:"productPage",data:function(){return{tempProduct:{imageUrl:[],options:{store:0}}}},props:{addNewItem:Boolean},computed:Object(c["c"])(["pid","product","productPage","loading"]),watch:{"productPage.open":{handler:function(){this.loadProduct()}}},methods:Object(s["a"])(Object(s["a"])({},Object(c["b"])(["setMsg","clearMsg","addProducts","editProduct","setTempProduct","clearTempProduct","togglePage","isLoading"])),{},{loadProduct:function(){var t=this;this.pid?(this.isLoading(!0),Object(u["e"])(this.pid).then((function(e){t.tempProduct=e.data.data,t.tempProduct.options?t.tempProduct.options=JSON.parse(t.tempProduct.options):t.tempProduct.options={store:null},t.isLoading(!1)}))):this.tempProduct=this.product},edit:function(t){var e=this,a=t.target.dataset.action;"create"===a?(this.isLoading(!0),this.tempProduct.options=JSON.stringify(this.tempProduct.options),Object(u["b"])(this.tempProduct).then((function(){e.$emit("update:addNewItem",!0),e.clearTempProduct(),e.isLoading(!1),e.togglePage()})).catch((function(){e.tempProduct.options=JSON.parse(e.tempProduct.options),e.setMsg({msg:"上傳".concat(e.tempProduct.title||"","失敗"),type:!1}),setTimeout((function(){e.clearMsg()}),1e3)}))):"update"===a&&(this.tempProduct.options=JSON.stringify(this.tempProduct.options),Object(u["f"])(this.tempProduct.id,this.tempProduct).then((function(t){var a=t.data.data;"string"===typeof a.options&&(a.options=JSON.parse(a.options)),e.editProduct({id:a.id,data:a}),e.clearTempProduct(),e.togglePage()})).catch((function(){e.tempProduct.options=JSON.parse(e.tempProduct.options),e.setMsg({msg:"更新".concat(e.tempProduct.title,"失敗"),type:!1}),setTimeout((function(){e.clearMsg()}),1e3)})))},cancel:function(){this.clearTempProduct(),this.togglePage()},toggle:function(t){t.target.className.includes("newDataPage")&&(this.clearTempProduct(),this.togglePage())}})},l=p,m=(a("587b"),a("2877")),g=Object(m["a"])(l,r,d,!1,null,"1226c696",null),v=g.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-wrap",attrs:{id:"pagination"}},[a("button",{staticClass:"page",attrs:{id:"prev"},on:{click:function(e){return t.changePage("m")}}},[t._v("«")]),t._l(t.pagination.total_pages,(function(e){return a("button",{key:e,staticClass:"page",class:{curpage:e===t.pagination.current_page},on:{click:function(a){return t.goToPage(e)}}},[t._v(t._s(e))])})),a("button",{staticClass:"page",attrs:{id:"next"},on:{click:function(e){return t.changePage("p")}}},[t._v("»")])],2)},P=[],h={name:"pagination",props:{pagination:Object},template:"#pagination",methods:{changePage:function(t){var e=this.pagination.current_page,a=this.pagination.total_pages;"p"===t?e<a&&this.$emit("update:pagination",this.pagination.current_page+=1):"m"===t&&e>1&&this.$emit("update:pagination",this.pagination.current_page-=1)},goToPage:function(t){this.$emit("update:pagination",this.pagination.current_page=t)}}},b=h,_=(a("0bb5"),Object(m["a"])(b,f,P,!1,null,"61706236",null)),w=_.exports,C={name:"product-manage",components:{productPage:v,pagination:w},data:function(){return{loadingConfig:{isLoading:!1,fullPage:!0},pagination:{},windowTop:null,addShow:!1,addNewItem:!1}},created:function(){this.getData()},mounted:function(){window.addEventListener("scroll",this.onScroll)},computed:Object(s["a"])({},Object(c["c"])(["products","productPage"])),watch:{product:function(){this.getData()},"pagination.current_page":{handler:function(){var t=this,e=this.pagination.current_page,a=this.$loading.show();Object(u["d"])(e).then((function(e){var o=e.data.data.map((function(t){var e=t.options;return"object"!==n(e)&&(t.options=t.options?JSON.parse(t.options):{store:null}),Object(u["e"])(t.id).then((function(e){t.description=e.data.data.description})),t}));t.setProducts(o),a.hide()}))}},addNewItem:{handler:function(){this.addNewItem&&(this.getData(),this.addNewItem=!1)}}},methods:Object(s["a"])(Object(s["a"])({},Object(c["b"])(["setProducts","delProduct","setTempProduct","clearTempProduct","togglePage"])),{},{getData:function(){var t=this,e=this.$loading.show();Object(u["d"])().then((function(a){var o=a.data.data.map((function(t){var e=t.options;return"object"!==n(e)&&(t.options=t.options?JSON.parse(t.options):{store:null}),Object(u["e"])(t.id).then((function(e){t.description=e.data.data.description})),t}));t.setProducts(o),e.hide(),t.pagination=a.data.meta.pagination}))},openPage:function(t){t||0===t?this.setTempProduct(this.products[t]):this.clearTempProduct(),this.togglePage()},deleteProduct:function(t){var e=this,a=this.products[t].title;this.$confirm({title:"刪除",message:"確認刪除 ".concat(a,"？\r\n（刪除後無法復原）"),button:{no:"取消",yes:"刪除"},callback:function(o){if(o){var i=e.$loading.show();Object(u["c"])(e.products[t].id).then((function(){e.delProduct(t),i.hide(),e.$confirm({message:"已刪除 ".concat(a),button:{no:"OK"}})}))}}})},onScroll:function(){this.windowTop=window.top.scrollY,this.windowTop>200?this.addShow=!0:this.addShow=!1}})},y=C,x=(a("4c33"),Object(m["a"])(y,o,i,!1,null,"18aa688b",null));e["default"]=x.exports},"7b4f":function(t,e,a){},ab13:function(t,e,a){var o=a("b622"),i=o("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[i]=!1,"/./"[t](e)}catch(o){}}return!1}},caad:function(t,e,a){"use strict";var o=a("23e7"),i=a("4d64").includes,n=a("44d2"),s=a("ae40"),c=s("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:!c},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n("includes")},d81d:function(t,e,a){"use strict";var o=a("23e7"),i=a("b727").map,n=a("1dde"),s=a("ae40"),c=n("map"),r=s("map");o({target:"Array",proto:!0,forced:!c||!r},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-70635ee9.99003b67.js.map